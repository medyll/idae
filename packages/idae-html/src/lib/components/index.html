<style>
  .components-root{padding:var(--gutter-lg);font-size:var(--font-md);color:var(--color-foreground)}
  .card{border:1px solid var(--color-border);padding:var(--gutter-md);margin:var(--gutter-sm) 0;background:var(--color-card);color:var(--color-card-foreground)}
</style>

<h1>idae-html examples</h1>
<div data-component="components-index" class="components-root">
  <div class="card">
    <h3>resizePanel</h3>
    <p>Fetches and inserts the generated component at <code>dist/resizePanel.html</code>.</p>
    <div data-ex-resize></div>
    <button data-load-resize>Load resizePanel</button>
  </div>

  <div class="card">
    <h3>exampleInline</h3>
    <p>Demonstrates the exampleInline component.</p>
    <div data-ex-exampleInline></div>
    <a href="./exampleInline/index.html">Open exampleInline demo</a>
  </div>

  <div class="card">
    <h3>moduleInline</h3>
    <p>Demonstrates the moduleInline component.</p>
    <a href="./moduleInline/index.html">Open moduleInline demo</a>
  </div>

  <div class="card">
    <h3>All component examples</h3>
    <p>Open individual demos:</p>
    <ul>
      <li><a href="./resizePanel/index.html">resizePanel</a></li>
      <li><a href="./exampleInline/index.html">exampleInline</a></li>
      <li><a href="./moduleInline/index.html">moduleInline</a></li>
      <li><a href="./modal/index.html">modal</a></li>
      <li><a href="./dropdown/index.html">dropdown</a></li>
      <li><a href="./tabs/index.html">tabs</a></li>
      <li><a href="./toast/index.html">toast</a></li>
      <li><a href="./inputs/index.html">inputs</a></li>
      <li><a href="./progress/index.html">progress</a></li>
      <li><a href="./accordion/index.html">accordion</a></li>
      <li><a href="./carousel/index.html">carousel</a></li>
      <li><a href="./tooltip/index.html">tooltip</a></li>
      <li><a href="./sidebar/index.html">sidebar</a></li>
      <li><a href="./card/index.html">card</a></li>
    </ul>
  </div>
</div>

<script type="module" lang="ts">
  import { be, createBe, core } from '$lib/core-engine.ts';

  core.registerComponent('components-index', {
    script: (root, props)=> {
      const rootEl = (root instanceof Element) ? root : root.node || document;
      const exResize = rootEl.querySelector('[data-ex-resize]');
      const loadResize = rootEl.querySelector('[data-load-resize]');
      const exExample = rootEl.querySelector('[data-ex-exampleInline]');

      async function loadResizePanel(){
        const mod = await import('/src/lib/moduleLib/resizePanel.ts');
        const init = mod.resizePanel || mod.default;
        const containerBe = be(exResize);
        const elBe = createBe('div', { className: 'idae-resize-panel', attributes: { 'data-component': 'resizePanel' } });
        elBe.update('<div class="panel">Resizable panel<br><small>Drag edge to resize</small></div>');
        containerBe.append(elBe);
        const el = Array.isArray(elBe.node) ? elBe.node[0] : (elBe.node);
        if (typeof init === 'function') init(el);
      }

      async function loadExampleInline(){
        const mod = await import('/src/lib/moduleLib/exampleInline.ts');
        const init = mod.exampleInline || mod.default;
        const containerBe = be(exExample);
        const elBe = createBe('div', { className: 'example-inline' });
        containerBe.append(elBe);
        const el = Array.isArray(elBe.node) ? elBe.node[0] : (elBe.node);
        if (typeof init === 'function') init(el);
      }

      if (loadResize) be(loadResize).on('click', loadResizePanel);
      // expose an anchor to load exampleInline if needed
      if (exExample) {
        // automatically load one exampleInline for preview
        loadExampleInline();
      }
      return () => {
        try{ if (loadResize) be(loadResize).off('click', loadResizePanel); }catch(e){}
      };
  },
    props: {},
    resources: [],
    on: {},
    meta: {
      author: 'idae-html',
      version: '1.0.0',
      description: 'An index component that loads and demonstrates other components.'
    }
  });
</script>
