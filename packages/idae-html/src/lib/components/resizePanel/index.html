<style lang="csss">
  body{font-family:system-ui,Arial,sans-serif;padding:16px}
  .row{display:flex;gap:12px}
  .panel{border:1px solid #aaa;padding:8px;background:#fafafa;min-width:80px;min-height:80px}
  .container{display:flex;align-items:flex-start;gap:8px}
  .note{color:#666;font-size:90%}
</style>

<h1>resizePanel component â€” demo</h1>
<p class="note">This demo imports the source ESM initializer from <code>src/lib/moduleLib/resizePanel.ts</code> for dev (no build required).</p>

<div data-component="resizePanel-demo">
  <div>
    <button data-add>Add panel</button>
    <button data-add-two>Add two panels side-by-side</button>
  </div>

  <div data-root></div>
</div>

<script type="module" lang="ts">
  import { be, createBe, core } from '$lib/core-engine.ts';

  core.registerComponent('resizePanel-demo', {
    script: (root, props)=> {
      const rootEl = (root instanceof Element) ? root : (root as any).node || document;
      const addBtn = rootEl.querySelector('[data-add]') as HTMLElement | null;
      const addTwoBtn = rootEl.querySelector('[data-add-two]') as HTMLElement | null;
      const containerBe = be(rootEl.querySelector('[data-root]'));
      if (!containerBe) return;

      async function addPanel(containerBeLocal){
        try{
          const mod = await import('/packages/idae-html/src/lib/moduleLib/resizePanel.ts');
          const init = mod.resizePanel || mod.default;
          const holderBe = createBe('div', { className: 'container' });
          const panelBe = createBe('div', { className: 'idae-resize-panel', attributes: { 'data-component': 'resizePanel' } });
          panelBe.update('<div class="panel">Resizable panel<br><small>Drag edge to resize</small></div>');
          holderBe.append(panelBe);
          containerBeLocal.append(holderBe);
          const panelEl = Array.isArray(panelBe.node) ? panelBe.node[0] : (panelBe.node as HTMLElement);
          if (typeof init === 'function') init(panelEl);
        }catch(e){ console.error(e); }
      }

      if (addBtn) be(addBtn).on('click', ()=> addPanel(containerBe));
      if (addTwoBtn) be(addTwoBtn).on('click', ()=> { addPanel(containerBe); addPanel(containerBe); });

      // auto add one on init
      addPanel(containerBe);

      return () => {
        try{ if (addBtn) be(addBtn).off('click'); }catch(e){}
        try{ if (addTwoBtn) be(addTwoBtn).off('click'); }catch(e){}
      };
    },
    props: {},
    resources: [],
    on: {},
    meta: {
      author: 'idae-html',
      version: '1.0.0',
      description: 'A demo component for the resizePanel functionality.'
    }
  });
</script>
